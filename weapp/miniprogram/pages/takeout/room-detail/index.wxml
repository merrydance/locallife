<!-- 包间详情页 -->
<custom-nav-bar title="包间详情" back-arrow bind:height="onNavHeight" />

<view class="container">
  <!-- 图片轮播 -->
  <swiper class="room-swiper" indicator-dots="{{room.images.length > 1}}" autoplay circular>
    <swiper-item wx:for="{{room.images}}" wx:key="*this">
      <t-image class="room-image" src="{{item}}" mode="aspectFill" bindtap="onPreviewImage" data-index="{{index}}" />
    </swiper-item>
    <swiper-item wx:if="{{room.images.length === 0 && room.primary_image}}">
      <t-image class="room-image" src="{{room.primary_image}}" mode="aspectFill" bindtap="onPreviewImage" data-index="0" />
    </swiper-item>
  </swiper>

  <!-- 基本信息 -->
  <view class="info-section">
    <view class="room-header">
      <text class="room-name">{{room.room_no}}</text>
      <view class="room-tags" wx:if="{{room.tags.length > 0}}">
        <t-tag wx:for="{{room.tags}}" wx:key="id" size="small" variant="light">{{item.name}}</t-tag>
      </view>
    </view>
    
    <view class="room-meta">
      <view class="meta-item">
        <text class="meta-label">容纳人数</text>
        <text class="meta-value">{{room.capacity}} 人</text>
      </view>
      <view class="meta-item" wx:if="{{room.minimum_spend}}">
        <text class="meta-label">最低消费</text>
        <text class="meta-value price">¥{{room.minimum_spend / 100}}</text>
      </view>
      <view class="meta-item">
        <text class="meta-label">月预订</text>
        <text class="meta-value">{{room.monthly_reservations}} 次</text>
      </view>
    </view>
    
    <view class="room-desc" wx:if="{{room.description}}">
      <text>{{room.description}}</text>
    </view>
  </view>

  <!-- 商户信息 -->
  <view class="merchant-section" bindtap="onMerchantTap">
    <view class="section-title">商户信息</view>
    <view class="merchant-card">
      <t-image wx:if="{{room.merchant_logo}}" class="merchant-logo" src="{{room.merchant_logo}}" mode="aspectFill" />
      <view class="merchant-info">
        <text class="merchant-name">{{room.merchant_name}}</text>
        <text class="merchant-address" wx:if="{{room.merchant_address}}">{{room.merchant_address}}</text>
      </view>
      <view class="merchant-actions">
        <t-button size="small" theme="light" icon="call" bindtap="onCallMerchant" catchtap="onCallMerchant">电话</t-button>
        <t-button size="small" theme="light" icon="location" bindtap="onNavigate" catchtap="onNavigate">导航</t-button>
      </view>
    </view>
  </view>
</view>

<!-- 底部操作栏 -->
<view class="bottom-bar" style="padding-bottom: env(safe-area-inset-bottom);">
  <t-button theme="primary" size="large" block bindtap="onReserve">预订包间</t-button>
</view>
