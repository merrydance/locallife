<custom-navbar title="营销活动" showBack="{{true}}" bind:navheight="onNavHeight">
  <view slot="right">
    <t-button size="small" icon="add" bindtap="onAddPromotion">新建</t-button>
  </view>
</custom-navbar>

<view class="page-container {{isLargeScreen ? 'large-screen' : ''}}" style="padding-top: {{navBarHeight}}px;">
  <t-loading wx:if="{{loading}}" theme="circular" size="40rpx" class="loading" />

  <view wx:if="{{!loading}}" class="promotions-container">
    <view wx:if="{{promotions.length === 0}}" class="empty">
      <t-empty description="暂无营销活动" />
    </view>

    <view wx:else class="promotions-grid">
      <view wx:for="{{promotions}}" wx:key="id" class="promo-card">
        <view class="promo-header">
          <text class="promo-name">{{item.name}}</text>
          <t-tag size="small" theme="{{item.status === 'ACTIVE' ? 'success' : 'default'}}">
            {{item.status === 'ACTIVE' ? '进行中' : '已结束'}}
          </t-tag>
        </view>

        <view class="promo-body">
          <view class="info-row">
            <text class="label">类型:</text>
            <text class="value">{{item.type === 'DISCOUNT' ? '折扣活动' : '满赠活动'}}</text>
          </view>
          <view class="info-row">
            <text class="label">内容:</text>
            <text class="value">{{item.description}}</text>
          </view>
          <view class="info-row">
            <text class="label">时间:</text>
            <text class="value">{{item.start_date}} ~ {{item.end_date}}</text>
          </view>
        </view>

        <view class="promo-actions">
          <t-button 
            size="small" 
            theme="{{item.status === 'ACTIVE' ? 'default' : 'primary'}}"
            data-id="{{item.id}}"
            bindtap="onToggleStatus"
          >
            {{item.status === 'ACTIVE' ? '结束' : '重启'}}
          </t-button>
        </view>
      </view>
    </view>
  </view>
</view>
