<view class="container">
  <t-tabs value="{{currentTab}}" bind:change="onTabChange" sticky>
    <t-tab-panel wx:for="{{tabs}}" wx:key="value" label="{{item.label}}" value="{{item.value}}" />
  </t-tabs>

  <view class="list-content">
    <view wx:if="{{reservations.length === 0 && !loading}}" class="empty-state">
        <t-empty icon="info-circle-filled" description="暂无预订" />
    </view>

    <view class="card" wx:for="{{reservations}}" wx:key="id">
      <view class="card-header">
        <text class="time">{{item._timeText}}</text>
        <t-tag theme="{{item._statusTheme}}">{{item._statusText}}</t-tag>
      </view>
      
      <view class="card-body">
        <view class="info-item">
          <t-icon name="user" size="32rpx" />
          <text>{{item.contact_name}} ({{item.party_size}}人)</text>
        </view>
        <view class="info-item" catchtap="onCallUser" data-phone="{{item.contact_phone}}">
          <t-icon name="call" size="32rpx" color="#0052d9" />
          <text style="color: #0052d9">{{item.contact_phone}}</text>
        </view>
        <view class="info-item" wx:if="{{item.notes}}">
          <t-icon name="info-circle" size="32rpx" />
          <text>{{item.notes}}</text>
        </view>
      </view>

      <view class="card-footer" wx:if="{{currentTab === 'pending'}}">
        <t-button size="small" theme="danger" variant="outline" data-id="{{item.id}}" bind:tap="onReject">拒绝</t-button>
        <t-button size="small" theme="primary" data-id="{{item.id}}" bind:tap="onConfirm">确认预订</t-button>
      </view>
    </view>
    
    <t-load-more status="{{loading ? 'loading' : (hasMore ? 'loading' : 'nomore')}}" />
  </view>

  <!-- Reject Dialog -->
  <t-dialog
    visible="{{showRejectDialog}}"
    title="拒绝预订"
    confirm-btn="确认拒绝"
    cancel-btn="取消"
    bind:confirm="confirmReject"
    bind:cancel="closeRejectDialog"
  >
    <view slot="content">
      <t-input placeholder="请输入拒绝原因" value="{{rejectReason}}" bind:change="onRejectInput" />
    </view>
  </t-dialog>
</view>
