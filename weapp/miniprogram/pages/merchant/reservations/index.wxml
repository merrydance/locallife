<custom-navbar title="预定管理" showBack="{{true}}" bind:navheight="onNavHeight" />

<view class="page-container {{isLargeScreen ? 'large-screen' : ''}}" style="padding-top: {{navBarHeight}}px;">
  <view class="tabs-section">
    <t-tabs value="{{activeTab}}" bind:change="onTabChange">
      <t-tab-panel label="待确认" value="PENDING" />
      <t-tab-panel label="已确认" value="CONFIRMED" />
      <t-tab-panel label="已完成" value="COMPLETED" />
    </t-tabs>
  </view>

  <t-loading wx:if="{{loading}}" theme="circular" size="40rpx" class="loading" />

  <view wx:if="{{!loading}}" class="reservations-container">
    <view wx:if="{{reservations.length === 0}}" class="empty">
      <t-empty description="暂无预定" />
    </view>

    <view wx:else class="reservations-grid">
      <view wx:for="{{reservations}}" wx:key="id" class="reservation-card">
        <view class="card-header">
          <text class="customer-name">{{item.customer_name}}</text>
          <t-tag size="small" theme="{{item.status === 'PENDING' ? 'warning' : 'success'}}">
            {{item.status === 'PENDING' ? '待确认' : item.status === 'CONFIRMED' ? '已确认' : '已完成'}}
          </t-tag>
        </view>

        <view class="card-body">
          <view class="info-row">
            <text class="label">联系电话:</text>
            <text class="value">{{item.customer_phone}}</text>
          </view>
          <view class="info-row">
            <text class="label">包间:</text>
            <text class="value">{{item.room_name}}</text>
          </view>
          <view class="info-row">
            <text class="label">人数:</text>
            <text class="value">{{item.guest_count}}人</text>
          </view>
          <view class="info-row">
            <text class="label">时间:</text>
            <text class="value">{{item.reservation_date}} {{item.reservation_time}}</text>
          </view>
          <view class="info-row">
            <text class="label">定金:</text>
            <text class="value price">¥{{item.deposit / 100}}</text>
          </view>
        </view>

        <view wx:if="{{item.status === 'PENDING'}}" class="card-actions">
          <t-button size="small" bindtap="onReject" data-id="{{item.id}}">拒绝</t-button>
          <t-button size="small" theme="primary" bindtap="onConfirm" data-id="{{item.id}}">确认</t-button>
        </view>
      </view>
    </view>
  </view>
</view>
