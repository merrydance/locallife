<!-- å ‚é£Ÿç®¡ç† - æ¡Œé¢çº§ SaaS ç•Œé¢ -->

<!-- å°å±æç¤º -->
<match-media max-width="1599">
  <view class="desktop-only-notice">
    <view class="notice-box">
      <view class="notice-icon">ğŸ–¥ï¸</view>
      <text class="notice-title">æ­¤åŠŸèƒ½éœ€è¦åœ¨ç”µè„‘ç«¯ä½¿ç”¨</text>
      <text class="notice-desc">è¯·ä½¿ç”¨ 1600px ä»¥ä¸Šåˆ†è¾¨ç‡çš„æ˜¾ç¤ºå™¨è®¿é—®</text>
      <navigator url="/pages/merchant/dashboard/index" class="btn-back">è¿”å›å·¥ä½œå°</navigator>
    </view>
  </view>
</match-media>

<!-- PC å…¨å±å¸ƒå±€ -->
<match-media min-width="1600">
  <view class="saas-layout">
    <merchant-header 
      merchant-name="{{merchantName}}"
      is-open="{{true}}"
    />

    <view class="page-container">
      <!-- é¡µé¢å¤´éƒ¨ -->
      <view class="page-header">
        <view class="page-title-section">
          <text class="page-title">å ‚é£Ÿç®¡ç†</text>
          <text class="page-subtitle">æ¡Œå°çŠ¶æ€ä¸å ‚é£Ÿä¼šè¯ç®¡ç†</text>
        </view>
        <view class="page-actions">
          <button class="btn-refresh" bindtap="loadData">
            <text>ğŸ”„ åˆ·æ–°</text>
          </button>
        </view>
      </view>

      <!-- Loading -->
      <view wx:if="{{loading}}" class="loading-container">
        <view class="loading-spinner"></view>
        <text>åŠ è½½ä¸­...</text>
      </view>

      <view wx:else class="content-area">
        <!-- ç»Ÿè®¡å¡ç‰‡ -->
        <view class="stats-cards">
          <view class="stat-card">
            <view class="stat-value">{{tableStats.total}}</view>
            <view class="stat-label">æ€»æ¡Œå°</view>
          </view>
          <view class="stat-card success">
            <view class="stat-value">{{tableStats.available}}</view>
            <view class="stat-label">ç©ºé—²</view>
          </view>
          <view class="stat-card warning">
            <view class="stat-value">{{tableStats.occupied}}</view>
            <view class="stat-label">ä½¿ç”¨ä¸­</view>
          </view>
        </view>

        <!-- åŒæ å¸ƒå±€ -->
        <view class="dual-column">
          <!-- å·¦æ ï¼šæ¡Œå°ç½‘æ ¼ -->
          <view class="column-left">
            <view class="section">
              <view class="section-header">
                <text class="section-title">ğŸª‘ æ¡Œå°åˆ—è¡¨</text>
              </view>
              
              <view wx:if="{{tables.length === 0}}" class="empty-state">
                <text class="empty-icon">ğŸª‘</text>
                <text class="empty-text">æš‚æ— æ¡Œå°æ•°æ®</text>
              </view>

              <view wx:else class="tables-grid">
                <view wx:for="{{tables}}" wx:key="id" 
                      class="table-card {{item.status === 'OCCUPIED' ? 'occupied' : (item.status === 'DISABLED' ? 'disabled' : '')}}">
                  <text class="table-name">{{item.name}}</text>
                  <text class="table-capacity">{{item.capacity}}äººæ¡Œ</text>
                  <view class="table-status-tag {{item.status === 'AVAILABLE' ? 'available' : (item.status === 'OCCUPIED' ? 'occupied' : 'disabled')}}">
                    {{item.status === 'AVAILABLE' ? 'ç©ºé—²' : (item.status === 'OCCUPIED' ? 'ä½¿ç”¨ä¸­' : 'åœç”¨')}}
                  </view>
                  <button wx:if="{{item.status === 'AVAILABLE'}}" 
                          class="btn-open-table" 
                          data-id="{{item.id}}" 
                          bindtap="onOpenTable">å¼€å°</button>
                  <button wx:if="{{item.status === 'OCCUPIED'}}" 
                          class="btn-close-table" 
                          data-id="{{item.id}}" 
                          bindtap="onCloseTable">ç»“å°</button>
                </view>
              </view>
            </view>
          </view>

          <!-- å³æ ï¼šè¿›è¡Œä¸­ä¼šè¯ -->
          <view class="column-right">
            <view class="section">
              <view class="section-header">
                <text class="section-title">ğŸ“‹ è¿›è¡Œä¸­çš„ä¼šè¯ ({{sessions.length}})</text>
              </view>
              
              <view wx:if="{{sessions.length === 0}}" class="empty-state">
                <text class="empty-icon">â˜•</text>
                <text class="empty-text">æš‚æ— è¿›è¡Œä¸­çš„ä¼šè¯</text>
              </view>

              <view wx:else class="sessions-list">
                <view wx:for="{{sessions}}" wx:key="id" class="session-card">
                  <view class="session-header">
                    <text class="table-name">{{item.table_name}}</text>
                    <view class="status-tag active">è¿›è¡Œä¸­</view>
                  </view>
                  <view class="session-footer">
                    <button class="btn-checkout" data-id="{{item.id}}" bindtap="onCheckout">ç»“è´¦</button>
                  </view>
                </view>
              </view>
            </view>
          </view>
        </view>
      </view>
    </view>
  </view>
</match-media>
