<custom-navbar title="商户管理" showBack="{{true}}" bind:navheight="onNavHeight" />

<view class="page-container {{isLargeScreen ? 'large-screen' : ''}}" style="padding-top: {{navBarHeight}}px;">
  <t-loading wx:if="{{loading}}" theme="circular" size="40rpx" class="loading" />

  <view wx:if="{{!loading}}" class="merchants-list">
    <view wx:if="{{merchants.length === 0}}" class="empty">
      <t-empty description="暂无商户" />
    </view>

    <view wx:else class="merchants-grid">
      <view wx:for="{{merchants}}" wx:key="id" class="merchant-card">
        <view class="card-header">
          <text class="merchant-name">{{item.name}}</text>
          <t-tag theme="{{item.status === 'ACTIVE' ? 'success' : 'danger'}}" size="small">
            {{item.status === 'ACTIVE' ? '营业中' : '已封禁'}}
          </t-tag>
        </view>

        <view class="card-body">
          <view class="info-row">
            <text class="label">负责人:</text>
            <text class="value">{{item.owner}}</text>
          </view>
          <view class="info-row">
            <text class="label">联系电话:</text>
            <text class="value">{{item.phone}}</text>
          </view>
          <view class="info-row">
            <text class="label">评分:</text>
            <text class="value rating">⭐ {{item.rating}}</text>
          </view>
          <view class="info-row">
            <text class="label">总订单:</text>
            <text class="value">{{item.order_count}}</text>
          </view>
        </view>

        <view class="card-actions">
          <t-button size="small" theme="default" data-id="{{item.id}}" bindtap="onViewDetail">查看详情</t-button>
          <t-button 
            size="small" 
            theme="{{item.status === 'ACTIVE' ? 'danger' : 'primary'}}" 
            data-id="{{item.id}}" 
            data-status="{{item.status}}"
            bindtap="onToggleStatus"
          >
            {{item.status === 'ACTIVE' ? '封禁' : '解封'}}
          </t-button>
        </view>
      </view>
    </view>
  </view>
</view>
