<custom-navbar title="运营中心" showBack="{{true}}" bind:navheight="onNavHeight" />

<view class="page-container" style="padding-top: {{navBarHeight}}px;">
  <t-loading wx:if="{{loading}}" theme="circular" size="40rpx" class="loading" />

  <view wx:if="{{!loading}}" class="content responsive-container">
    <!-- 核心指标 -->
    <view class="stats-grid responsive-grid-4">
      <view class="stat-card">
        <text class="label">总GMV</text>
        <text class="value">¥{{stats.total_gmv_display}}</text>
      </view>
      <view class="stat-card">
        <text class="label">总订单</text>
        <text class="value">{{stats.total_orders}}</text>
      </view>
      <view class="stat-card">
        <text class="label">活跃商户</text>
        <text class="value">{{stats.active_merchants}}</text>
      </view>
      <view class="stat-card">
        <text class="label">活跃骑手</text>
        <text class="value">{{stats.active_riders}}</text>
      </view>
    </view>

    <!-- 待办事项 -->
    <view class="todo-section">
      <view class="section-title">待办审批</view>
      <view wx:if="{{pending_approvals.length === 0}}" class="empty">
        <t-empty description="暂无待办事项" />
      </view>
      
      <view wx:else class="approval-list">
        <view wx:for="{{pending_approvals}}" wx:key="id" class="approval-item">
          <view class="item-info">
            <t-tag theme="primary" variant="light" size="small" class="tag">
              {{item.type === 'MERCHANT_JOIN' ? '商户' : '骑手'}}
            </t-tag>
            <text class="item-name">{{item.name}}</text>
            <text class="item-time">{{item.created_at}}</text>
          </view>
          <view class="item-actions">
            <t-button size="small" theme="danger" variant="text" data-id="{{item.id}}" bindtap="onReject">拒绝</t-button>
            <t-button size="small" theme="primary" data-id="{{item.id}}" bindtap="onApprove">通过</t-button>
          </view>
        </view>
      </view>
    </view>

    <!-- 快捷入口 -->
    <view class="shortcuts-section">
      <view class="section-title">快捷管理</view>
      <view class="shortcuts-grid">
        <navigator url="/pages/operator/merchants/index" class="shortcut-item">
          <t-icon name="shop" size="48rpx" color="#0052D9" />
          <text>商户管理</text>
        </navigator>
        <navigator url="/pages/operator/rules/index" class="shortcut-item">
          <t-icon name="setting" size="48rpx" color="#00A870" />
          <text>规则配置</text>
        </navigator>
        <navigator url="/pages/operator/automation/index" class="shortcut-item">
          <t-icon name="control-platform" size="48rpx" color="#ED7B2F" />
          <text>自动化</text>
        </navigator>
        <navigator url="/pages/operator/claims/index" class="shortcut-item">
          <t-icon name="error-circle" size="48rpx" color="#E34D59" />
          <text>异常仲裁</text>
        </navigator>
      </view>
    </view>
  </view>
</view>
